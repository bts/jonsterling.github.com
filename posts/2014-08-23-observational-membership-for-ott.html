<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta name="readability-verification" content="cG3MqZcEVveKZ6mnEFkePAL3Ug79Jxxp5Fn27CM7" />
<title>JS ⊢ Observational Membership for Intensional Type Theory</title>
<link rel="stylesheet" type="text/css" href="../css/screen.css" />
<link rel="stylesheet" type="text/css" href="../css/syntax.css" />
<link rel="stylesheet" type="text/css" href="../css/coqdoc.css" />
<style type="text/css">
    @import url(http://nmashton.ca/css/gloss-0.0.1.css);
</style>
<script type="text/javascript" src="http://code.jquery.com/jquery-1.8.3.min.js"></script>
<script type="text/javascript" src="http://nmashton.ca/js/gloss-0.0.1.js"></script>
<link rel="alternate" type="application/rss+xml" title="Jonathan Sterling" href="../rss.xml" />


<!--[if IE]>
  <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
<!--[if lte IE 7]>
  <script src="js/IE8.js" type="text/javascript"></script><![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" type="text/css" media="all" href="css/ie6.css"/><![endif]-->

<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
MathJax.Hub.Config({
  showMathMenu: false,
  showProcessingMessages: false,
  messageStyle: "none",
  'HTML-CSS': {
    availableFonts: [],
    webFont: 'TeX',
  },
  TeX: {
    Macros: {
      gk: ["\\style{font-family:Junicode!important; font-size:1.3em;}{\\text{#1}}", 1]
    }
  }
});
</script>
</head>
<body>

<header>
<h1><a href="../index.html"><span class="title">Observational Membership for Intensional Type Theory.</span></a></h1>
</header>

<section class="post">
<article><p>The key idea of Observational Type Theory<a href="#fn1" class="footnoteRef" id="fnref1"><sup>1</sup></a> is to make the <em>propositional</em> equality coextensive with the equality which is validated under the standard semantics for Type Theory, which is the meaning explanations and their metamathematical counterpart, the realizability interpretation. Now, Extensional Type Theory is usually characterized in terms of typechecking (membership) being undecidable because the “true” equality is made to hold judgementally; but this is a deceptive characterization when applied to Computational Type Theory (Nuprl), since there are many types besides equality which may be given meaning explanations but which have an undecidable typing judgement.</p>
<!--more-->

<p>Now, Oury’s result<a href="#fn2" class="footnoteRef" id="fnref2"><sup>2</sup></a> tells us that by peppering a term with identity proofs and coercions, one can prove all the theorems of ETT in ITT extended with an equality type which represents the observational equivalence of programs; but Oury only considers one source of synthetic judgement, which is the equality reflection rule. Observational Type Theory can be thought of as a version of ETT which has all analytic judgements, by turning the semantical equality judgement into a proposition and retaining a syntactic equality judgement.</p>
<p>In CTT, you do not have the syntactic typing judgement <span class="math">\(\Gamma\vdash M:A\)</span>; instead you have a semantical membership judgement <span class="math">\(\Gamma\vdash M\in A\)</span> which is the reflexive special case of the semantical equality judgement <span class="math">\(\Gamma\vdash M=M\in A\)</span>. So what would happen if we extended OTT with a semantical membership proposition?</p>
<h3 id="an-example-ctt-type">An Example CTT Type</h3>
<p>First, we should consider why this is even an interesting idea. Consider a type given in CTT by the following rules:</p>
<p><span class="math">\[\begin{gather}
\frac{
  \Gamma\vdash A=A'\in\mathbb{U}_i
  \quad
  \Gamma,x:A\vdash B[x]=B'[x]\in\mathbb{U}_i
}{
  \Gamma\vdash \{x:A\mid B[x]\} = \{x:A'\mid B'[x]\}\in \mathbb{U}_i
}\tag{subset-F}\\[6pt]
%
\frac{
  \Gamma\vdash M=M'\in A
  \quad
  \Gamma\vdash B[M]\ \mathrm{true}
  \quad
  \Gamma,x:A\vdash B[x]\in\mathbb{U}_i
}{
  \Gamma\vdash M=M'\in\{x:A\mid B[x]\}
}\tag{subset-I}\\[6pt]
%
\frac{
  \Gamma\vdash M=M'\in\{x:A\mid B[x]\}
}{
  \Gamma\vdash M=M'\in A
}\tag{subset-E$_1$}\\[6pt]
%
\frac{
  \Gamma\vdash M=M'\in\{x:A\mid B[x]\}
}{
  \Gamma\vdash B[M]\ \mathrm{true}
}\tag{subset-E$_2$}
\end{gather}\]</span></p>
<p>Now then, with careful modification to the formation, introduction and elimination rules, this type could be given in a type theory without equality reflection: but its membership would still be undecidable. And the source of the undecidability is the second premise of the introduction rule, the proof of which does not appear in the term. But this is clearly a useful type, as decades of work in Nuprl have demonstrated!</p>
<p>But sadly because it attacks only the problem of making equality judgements analytic, OTT does not suffice to make such types expressible, except in terms of a product with a squashed second projection: <span class="math">\[\textstyle
  \{x:A\mid B[x]\} \Longrightarrow_{ITT} \sum_{(x:A)}\|B[x]\|
\]</span></p>
<p>This interpretation actually works fine, in that it validates all the rules above. And similar characterizations could be given to the other types of CTT, such as intersections and unions; but as can be seen from my <a href="http://www.jonmsterling.com/posts/2014-05-28-family-unions-in-intensional-type-theory.html">previous attempt</a>, the construction is very complicated and worringly non-general.</p>
<h3 id="intensional-approximations-are-ad-hoc">Intensional approximations are ad hoc</h3>
<p>The crux of the matter is that whilst intensional approximations of most computational types may be given, the beauty and unity of their characterization in CTT is lost, and they must all be interpreted separately in terms of a closed universe. This is contrary to the idea of the meaning explanations, which necessitates an open universe where a type is introduced by providing a meaning explanation which says what it means to be a member of that type, and when two members are equal, and which justifies local consistency and completeness.</p>
<p>In terms of an OTT-like system, that means that to introduce a new type, it should suffice to explain the behavior of the heterogeneous equality on it and its terms: then propositional membership is reflexivity in that relation.</p>
<h3 id="the-propositional-equality-and-membership-types">The propositional equality and membership types</h3>
<p>Let us consider the propositional equality type of OTT, which is heterogeneous:</p>
<p><span class="math">\[
\frac{
  \Gamma\vdash A:\mathbb{U}_i
  \quad
  \Gamma\vdash B:\mathbb{U}_i
  \quad
  \Gamma\vdash M:A
  \quad
  \Gamma\vdash N:B
}{
  \Gamma\vdash M\in A = N\in B : \mathbb{U}_i
}\tag{Eq-F}
\]</span></p>
<p>We’ll define the following shorthands: <span class="math">\[\begin{align}
M=N\in A&amp;\triangleq M\in A = N\in A\\
\widehat{x:A} &amp;\triangleq x_0:A_0, x_1:A_1, \tilde{x}:(x_0\in A_0 = x_1\in A_1)
\end{align}\]</span></p>
<p>There are various elimination forms which represent coercion across type equalities, and which bear witness to the extensionality of all constructions in type theory. But the equality type is defined by recursion on the types, and so instead of introduction rules, it has computation rules. And so the meaning of a type is given by the computation of the equality of its terms. For instance, the rules for functions are given as follows:</p>
<p><span class="math">\[\begin{align}
\textstyle
(\prod_{(x:A_0)}B_0[x] = \prod_{(x:A_1)}B_1[x]\in\mathbb{U}_i)
  &amp; \leadsto
    (A_0=A_1\in\mathbb{U}_i) \times \textstyle\prod_{(\widehat{x:A})}B_0[x_0]=B_1[x_1]\in\mathbb{U}_i\\
\textstyle
(f\in\prod_{(x:A_0)}B_0[x] = g\in\prod_{(x:A_1)}B_1[x])
  &amp; \leadsto
    \textstyle
    \prod_{(\widehat{x:A})} f(x_0)\in B_0[x_0] = g(x_1)\in B_1[x_1]
\end{align}\]</span></p>
<p>Now, one might think to add propositional membership like this: <span class="math">\(M\in A\triangleq M=M\in A\)</span>. But this seems like it will be degenerate, since we already know from the formation rule for equality that <span class="math">\(M:A\)</span>, so there is nothing added by having <span class="math">\(p:M\in A\)</span>. But this is not in fact the case! Consider the interpretation of equality of equality types:</p>
<p><span class="math">\[\begin{array}{lcl}
(M_0\in A_0=N_0\in B_0) = (M_1\in A_1=N_1\in B_1) \in \mathbb{U}_i
  &amp;\leadsto &amp;(A_0=A_1\in\mathbb{U}_i)\\
  &amp;\times &amp;(B_0=B_1\in\mathbb{U}_i)\\
  &amp;\times &amp;(M_0\in A_0=M_1\in A_1)\\
  &amp;\times &amp;(N_0\in B_0=N_1\in B_1)
\end{array}\]</span></p>
<p>Considering the presence of this kind of rule, certainly there are then semantic types “T” such that <span class="math">\(T\in\mathbb{U}_i\)</span> is provable for some <span class="math">\(i\)</span>, but for which <span class="math">\(T:\mathbb{U}_i\)</span> is not evident. So how do we make this useful? Clearly for some proof <span class="math">\(p:M\in A\)</span> we should like to be able to recover some term <span class="math">\(\underline{p}:A\)</span>; but we cannot in general have <span class="math">\(\underline{p}=M:A\)</span> without tossing subject reduction. Consider</p>
<div class="footnotes">
<hr />
<ol>
<li id="fn1"><p>Thorsten Altenkirch, Conor McBride, Wouter Swierstra (2007). <a href="http://dl.acm.org/citation.cfm?id=1292597.1292608">Observational equality, now!</a><a href="#fnref1">↩</a></p></li>
<li id="fn2"><p>Nicolas Oury (2005). <a href="http://link.springer.com/chapter/10.1007%2F11541868_18">Extensionality in the Calculus of Constructions</a><a href="#fnref2">↩</a></p></li>
</ol>
</div></article>
<h1>Want to comment?</h1>
<p> I’m @jonsterling on <a href="http://www.twitter.com/jonsterling">Twitter</a>.


<script src="//static.getclicky.com/js" type="text/javascript"></script>
<script type="text/javascript">try{ clicky.init(66625087);
    }catch(e){}</script>
<noscript><p><img alt="Clicky" width="1" height="1" src="//in.getclicky.com/66625087ns.gif" /></p></noscript>

<a rel="me" href="http://twitter.com/jonsterling"></a>
<a rel="me" href="https://alpha.app.net/jonsterling"></a>
</body>
</html>

